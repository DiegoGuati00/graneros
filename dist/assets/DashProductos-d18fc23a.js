import{r as c,u as R,G as T,j as f,a,b as d}from"./index-39a70ab6.js";import{S as j}from"./sweetalert2.esm.all-6401f406.js";const F=()=>{const[h,b]=c.useState(""),[p,C]=c.useState(""),[m,v]=c.useState(0),[u,w]=c.useState([]),[r,x]=c.useState([]),[B,A]=c.useState(""),[N,S]=c.useState([]);c.useState([]);const[g,I]=c.useState("C"),{productoID:i=null}=R();new T;const y=t=>{if(t.preventDefault(),!h||!p||!m)return;let e={title:h,description:p,categoryId:parseInt(B),price:parseInt(m)};if(console.log(e),g=="C")d({method:"post",url:"https://api.escuelajs.co/api/v1/files/upload",data:{file:r[0]},headers:{"Content-Type":"multipart/form-data"}}).then(s=>{console.log(s),e.images=[s.data.location],d({method:"post",url:"https://api.escuelajs.co/api/v1/products/",data:e}).then(l=>{window.location.replace("/dashboard/producto/"+l.data.id)})});else if(r.length)d({method:"post",url:"https://api.escuelajs.co/api/v1/files/upload",data:{file:r[0]},headers:{"Content-Type":" multipart/form-data"}}).then(s=>{console.log(s);let l=u,o=[];l.map(n=>{n=n.replaceAll("[",""),n=n.replaceAll("]",""),n=n.replaceAll('"',""),n=n.replaceAll("\\",""),o.push(n)}),o.push(s.data.location),e.images=o,console.log(e),d({method:"put",url:"https://api.escuelajs.co/api/v1/products/"+i,data:e}).then(n=>{window.location.replace("/dashboard/producto/"+n.data.id)})});else{let s=u,l=[];s.map(o=>{o=o.replaceAll("[",""),o=o.replaceAll("]",""),o=o.replaceAll('"',""),o=o.replaceAll("\\",""),l.push(o)}),e.images=l,d({method:"put",url:"https://api.escuelajs.co/api/v1/products/"+i,data:e}).then(o=>{window.location.reload()})}},E=t=>{(()=>{fetch("https://api.escuelajs.co/api/v1/products/"+t,{method:"DELETE"}).then(l=>{l.json().then(o=>{window.location.replace("/dashboard")})})})()},D=(t,e)=>{fetch("https://api.escuelajs.co/api/v1/products/"+t).then(l=>{l.json().then(o=>{e(o)}).catch(o=>{window.location.replace("/dashboard"),console.log(o)})})},P=t=>{console.log(t);let e=[];u.map(s=>{s!=t&&e.push(s)}),w(e)};return c.useEffect(()=>{i&&D(i,e=>{console.log(e),b(e.title),C(e.description),v(e.price),A(e.category.id),w(e.images),I("E")}),fetch("https://api.escuelajs.co/api/v1/categories").then(e=>{e.json().then(s=>{S(s)})})},[]),c.useEffect(()=>()=>{},[r]),f("div",{className:"q2",id:"DashProductos",children:[a("div",{className:"divprin",children:a("div",{className:"PRIN1",children:f("form",{onSubmit:y,children:[a("h1",{children:"PRODUCTO"}),a("label",{htmlFor:"nombreC",children:"NOMBRE"}),a("input",{onChange:t=>b(t.target.value),value:h,id:"nombreC",type:"text",title:"INGRESE NOMBRE"}),a("label",{htmlFor:"CCcedula",children:"descripcion"}),a("textarea",{name:"",id:"CCcedula",onChange:t=>C(t.target.value),value:p,style:{width:"100%",background:"#32cd32",height:"100px"},children:p}),a("select",{name:"",id:"",onChange:t=>A(t.target.value),value:B,children:N.map((t,e)=>a("option",{value:t.id,children:t.name},e))}),a("label",{htmlFor:"precio",children:"precio"}),a("input",{onChange:t=>v(t.target.value),value:m,type:"number",min:0,id:"precio"}),a("div",{className:"C-imagenes",children:u.map(t=>{let e=t;return e=e.replaceAll("[",""),e=e.replaceAll("]",""),e=e.replaceAll('"',""),e=e.replaceAll("\\",""),f("div",{className:"imagenes-C1",children:[a("p",{onClick:s=>P(t),children:"x"}),a("img",{src:e,alt:""})]})})}),a("input",{type:"file",name:"",id:"",onChange:t=>{let e=t.target.files,s=[];for(let l=0;l<=e.length-1;l++)s.push(e[l]);x(s)}}),a("div",{className:"C-imagenes",children:r.map(t=>a("div",{className:"imagenes-C1",children:a("img",{src:URL.createObjectURL(t),alt:""})}))}),a("input",{type:"submit",value:g=="C"?"crear":"editar"})]})})}),g!="C"?a("div",{children:a("button",{onClick:()=>{const t=j.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});t.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.isConfirmed?(E(i),t.fire({title:"Deleted!",text:"articulo eliminado",icon:"success"})):e.dismiss===j.DismissReason.cancel&&t.fire({title:"Cancelled",icon:"error"})})},children:"eliminar producto"})}):null]})};export{F as default};
