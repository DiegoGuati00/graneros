import{r as o,d as C,A as P,G as x,u as j,b as w,j as e,a}from"./index-39a70ab6.js";const S=()=>{const[n,f]=o.useState([]),[c,d]=o.useState([]),[u,g]=o.useState(0);C();const{auth:l,setAuth:N}=o.useContext(P),p=new x,{compraID:h}=j(),v=()=>{c.length&&(p.new("compra",{productos:c,usuario:l.id,fecha:new Date().toUTCString(),price:u},t=>{window.location.replace("/compras/"+t)}),c.map(t=>{p.delete("carrito",t.id)}),d([]))};return o.useEffect(()=>(w({method:"get",url:"https://api.escuelajs.co/api/v1/products/"}).then(t=>{console.log(t),t.status==200&&p.get("carrito",function(s){let r=[];console.log(l),s.map(i=>{i.usuario==l.id&&t.data.map(m=>{m.id==i.producto&&(i.producto=m,r.push(i))})}),f(r)})}),()=>{}),[]),o.useEffect(()=>{h==null?(console.log("hola"),d(n)):(console.log("holi"),n.map(t=>{t.producto.id==parseInt(h)&&d([t])}))},[n]),o.useEffect(()=>{let t=0;return c.map(s=>{let r=s.cantidad*s.producto.price;t+=r}),g(t),()=>{}},[c]),e("div",{id:"Comprar",children:[a("div",{children:c.map(t=>(console.log(t),e("div",{className:"PC",children:[a("div",{className:"PC-img",children:a("img",{src:t.producto.images[0],alt:""})}),e("div",{className:"PC-info",children:[a("p",{children:t.producto.title}),e("p",{children:["cantidad ",t.cantidad]}),e("p",{children:["$",t.cantidad*t.producto.price]})]})]})))}),e("div",{className:"TP",children:[e("div",{className:"TP-C1",children:[a("p",{children:"pagas"}),e("p",{children:["$ ",u]})]}),a("div",{children:a("button",{onClick:v,children:"pagar"})})]})]})};export{S as default};
