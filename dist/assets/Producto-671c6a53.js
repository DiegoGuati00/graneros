import{j as p,F as x,a as t,G as A,u as C,c as N,r as h,A as k,b as I}from"./index-39a70ab6.js";import{u as v}from"./keen-slider.min-9c2a669f.js";import{S as f}from"./sweetalert2.esm.all-6401f406.js";function T(r){return a=>{function l(){a.slides.forEach(i=>{i.classList.remove("active")})}function c(i){a.slides[i].classList.add("active")}function s(){a.slides.forEach((i,e)=>{i.addEventListener("click",()=>{r.current&&r.current.moveToIdx(e)})})}a.on("created",()=>{r.current&&(c(a.track.details.rel),s(),r.current.on("animationStarted",i=>{l();const e=i.animator.targetIdx||0;c(i.track.absToRel(e)),a.moveToIdx(Math.min(a.track.details.maxIdx,e))}))})}}const b=({galeria:r=[]})=>{const[a,l]=v({initial:0}),[c]=v({initial:0,slides:{perView:4,spacing:10}},[T(l)]);return p(x,{children:[t("div",{ref:a,className:"keen-slider",children:r.map((s,i)=>{setTimeout(()=>{l.current.update()},400);let e=s;return e=e.replaceAll("[",""),e=e.replaceAll("]",""),e=e.replaceAll('"',""),e=e.replaceAll("\\",""),console.log(e),t("div",{className:"keen-slider__slide",children:t("img",{src:e,alt:""})},"a"+i)})}),t("div",{ref:c,className:"keen-slider thumbnail",children:r.map((s,i)=>{let e=s;return e=e.replaceAll("[",""),e=e.replaceAll("]",""),e=e.replaceAll('"',""),e=e.replaceAll("\\",""),t("div",{className:"keen-slider__slide",children:t("img",{src:e,alt:""})},"h"+i)})})]})},P=()=>{const r=new A,{productoID:a,productoTitulo:l}=C(),c=N(),{auth:s,setAuth:i}=h.useContext(k),[e,g]=h.useState({});return h.useEffect(()=>{I({method:"get",url:"https://api.escuelajs.co/api/v1/products/"+a}).then(n=>{if(n.status==200){if(!l){let o=n.data.title;o=o.replaceAll(" ","-"),c("/producto/"+a+"/"+o)}g(n.data)}console.log(n)}).catch(n=>{c("/")})},[]),t("div",{id:"Producto",children:p("div",{className:"C-Producto",children:[t("div",{className:"C-slider",children:t(b,{galeria:e.images})}),p("div",{className:"C-1",children:[p("div",{className:"C-info",children:[t("div",{className:"C-title",children:t("p",{children:e.title})}),t("div",{className:"C-price",children:p("p",{children:["$",e.price]})}),t("div",{className:"C-descripcion",children:t("p",{children:e.description})})]}),t("div",{className:"C-btns",children:t("button",{onClick:n=>{s?r.get("carrito",o=>{let d=parseInt(a),m=!1;o.map(u=>{console.log(u.producto==d&&u.usuario==s.id),u.producto==d&&u.usuario==s.id&&(m=u)}),m?r.put("carrito",m.id,{usuario:s.id,producto:parseInt(a),cantidad:m.cantidad+1}):r.new("carrito",{usuario:s.id,producto:parseInt(a),cantidad:1}),f.fire({icon:"success",title:"produccto agregado al carrito"})}):f.mixin({}).fire({title:"Â¿tienes una cuenta?",icon:"warning",showCancelButton:!0,confirmButtonText:"login",cancelButtonText:"crear cuenta",reverseButtons:!0}).then(d=>{d.isConfirmed?c("/login"):d.dismiss===f.DismissReason.cancel&&c("/registroUsuario")})},children:"agregar al carrito"})})]})]})})};export{P as default};
